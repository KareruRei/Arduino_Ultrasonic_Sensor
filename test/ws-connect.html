<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple WebSocket Tester</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 20px auto; line-height: 1.6; }
        #log { font-size: smaller; height: 300px; border: 1px solid #ccc; overflow-y: scroll; padding: 10px; background: #f9f9f9; margin-top: 10px; }
        .input-group { margin-bottom: 10px; }
        input[type="text"] { width: 70%; padding: 8px; }
        button { padding: 8px 15px; cursor: pointer; }
        .status { font-weight: bold; }
        .sent { color: blue; }
        .received { color: green; }
        .error { color: red; }
    </style>
</head>
<body>

    <h2>WebSocket Tester</h2>

    <div class="input-group">
        <input type="text" id="wsUrl" value="wss://echo.websocket.org" placeholder="ws://localhost:8080">
        <button id="connectBtn">Connect</button>
        <button id="disconnectBtn" disabled>Disconnect</button>
    </div>

    <div class="input-group">
        <input type="text" id="messageInput" placeholder="Type a message..." disabled>
        <button id="sendBtn" disabled>Send</button>
    </div>

    <div>Status: <span id="status" class="status">Disconnected</span></div>
    
    <div id="log"></div>

    <script>
        let socket;
        const log = document.getElementById('log');
        const status = document.getElementById('status');
        const wsUrl = document.getElementById('wsUrl');
        const connectBtn = document.getElementById('connectBtn');
        const disconnectBtn = document.getElementById('disconnectBtn');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');

        function writeToLog(message, className) {
            const div = document.createElement('div');
            div.className = className;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
        }

        connectBtn.onclick = () => {
            socket = new WebSocket(wsUrl.value);

            socket.onopen = () => {
                status.textContent = "Connected";
                status.style.color = "green";
                connectBtn.disabled = true;
                disconnectBtn.disabled = false;
                messageInput.disabled = false;
                sendBtn.disabled = false;
                writeToLog("Connected to " + wsUrl.value, "");
            };

            socket.onmessage = (event) => {
                writeToLog("Received: " + event.data, "received");
            };

            socket.onclose = () => {
                status.textContent = "Disconnected";
                status.style.color = "red";
                connectBtn.disabled = false;
                disconnectBtn.disabled = true;
                messageInput.disabled = true;
                sendBtn.disabled = true;
                writeToLog("Connection closed.", "");
            };

            socket.onerror = (error) => {
                writeToLog("Error: " + error.message, "error");
            };
        };

        disconnectBtn.onclick = () => {
            if (socket) socket.close();
        };

        sendBtn.onclick = () => {
            const msg = messageInput.value;
            if (socket && socket.readyState === WebSocket.OPEN) {
                socket.send(msg);
                writeToLog("Sent: " + msg, "sent");
                messageInput.value = "";
            }
        };
    </script>
</body>
</html>